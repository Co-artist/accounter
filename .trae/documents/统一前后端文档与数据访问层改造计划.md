## 目标
- 更新文档，统一前后端认知（运行、环境、API）。
- 在前端新增统一数据访问层（DAL），逐步从 localStorage 过渡到后端 API。
- 完善环境变量示例，覆盖前后端所需配置。
- 增强错误处理与可观测性（后端中间件 + 前端 toast/snackbar）。

## 文档更新
- 根目录 `README.md`：
  - 增加后端运行指南（`.env`、`npm run dev`、端口/健康检查）。
  - 增加 API 快速说明（`/api/auth/*`、`/api/feedback/*`，字段示例）。
  - 增加 Supabase 迁移/校验命令说明（`migrate:*`）。
- 新增 `docs/API.md`：
  - 详细接口契约：请求/响应、错误码、鉴权示例、分页/排序预留。
  - 示例 cURL/PowerShell 片段。
- 新增 `docs/ENV.md`：
  - 前后端环境变量清单与说明（含默认值与安全注意）。

## 环境变量示例
- 根目录新增 `.env.example`（不提交真实值）：
  - 后端：`SUPABASE_URL`、`SUPABASE_SERVICE_ROLE_KEY`、`JWT_SECRET`、`JWT_EXPIRES_IN`、`PORT`。
  - 前端：`VITE_API_BASE_URL`（默认 `http://localhost:5001/api`）。
- 将 `.gitignore` 确保忽略 `.env*`。

## 前端数据访问层（DAL）
- 新建 `src/api/client.ts`：基于现有 `axiosInstance`，读取 `import.meta.env.VITE_API_BASE_URL`。
- 新建 `src/api/modules/auth.ts`、`feedback.ts`：封装 API 函数（`login/register/me`、`create/getMine/getAll`）。
- 新建 `src/api/errors.ts`：统一错误类型与消息提取（状态码映射）。
- 在 `src/store/index.js` 中引入 DAL 的可插拔策略：
  - 保留 localStorage 逻辑为默认实现。
  - 增加切换开关（如 `VITE_USE_REMOTE=true`），启用后端数据路径用于对应实体（先从反馈模块开始演练）。

## 前端错误提示
- 新建 `src/components/Toast.vue` 与简单事件总线，或复用现有 UI；
- 在 `axiosInstance` 响应拦截器内触发 toast（401、403、404、5xx），文案来源于 `i18n`；
- 在页面级捕获（如登录失败）显示友好提示。

## 后端错误处理中间件与日志
- 新建 `backend/middleware/errorHandler.js`：捕获未处理错误，返回结构化 JSON（`{ message, code }`）。
- 在 `server.js` 末尾 `app.use(errorHandler)` 挂载；
- 增强 `lib/logger.js`：添加错误级别、时间戳格式；在控制器捕获处使用 `logger.error`。

## 渐进式切换策略
- 阶段 1：仅反馈模块走后端 API（便于验证与观察）。
- 阶段 2：交易与分类的读路径先接入 API，写路径仍保留本地，提供同步按钮。
- 阶段 3：全面切换为后端持久化；提供数据导入/导出工具（CSV/JSON）。

## 验证与交付
- 本地运行：后端连通性测试、API 手工验证；前端 toast 展示与 i18n 文案检查。
- 文档自检：确保 README、API、ENV 文档完整可执行。

## 成果
- 统一的开发文档与环境指南；
- 前端具备可配置的数据访问层与错误提示；
- 后端具备统一错误处理与结构化日志；
- 可渐进迁移到后端存储，风险可控。