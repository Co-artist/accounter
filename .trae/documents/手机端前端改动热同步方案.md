## 目标
- 已安装 APP 在启动时自动获取最新前端资源，无需用户重新下载 APK；发布可控、可回滚。

## 服务端实现
- 提供“更新检查”接口（HTTPS）：返回当前最新版本与下载地址
- 最小返回格式（建议）：
```
{
  "version": "1.0.3",            // 前端资源版本，字符串即可
  "url": "https://cdn.example.com/releases/dist-1.0.3.zip", // Zip 包下载地址
  "checksum": "sha256:...",      // 可选，用于完整性校验
  "note": "修复滑动卡顿，优化动画" // 可选，给前端弹窗展示
}
```
- 将构建产物 `dist/` 压缩为 Zip（例如 `dist-1.0.3.zip`），上传到 CDN/对象存储（S3/OSS）
- 保留历史包与版本（支持回滚）；控制台或接口把最新版本指向目标 Zip

## 客户端配置
- 在 `capacitor.config.ts`：
  - `plugins.CapacitorUpdater.autoUpdate = true`
  - `plugins.CapacitorUpdater.url = "https://api.example.com/updates/check"`（指向上面的检查接口）
- 保持 `server` 正常（生产包通常不再指向开发服务器）

## 客户端交互建议
- 启动时：插件自动请求更新 → 下载并应用；必要时提示“更新完成，将在下次启动生效”
- 增强：保留“手动检查更新”入口；当 `note` 存在时弹出更新说明（你项目内已有 `UpdateModal`，可共用该文案）

## 发布流程（每次）
1. 在 Android Studio 真机/模拟器验证前端改动
2. 执行 `npm run build`，生成 `dist/`
3. 压缩 `dist/` → 上传到 CDN（得到 Zip 的 HTTPS 链接）
4. 更新检查接口：设置 `version` 与 `url` 指向新的包；填写 `note`
5. 用户下次打开 APP：自动拉取并应用最新前端资源

## 回滚流程
- 将检查接口的 `version/url` 指回上一包；用户启动时将恢复到旧版本

## 校验与安全
- 使用 HTTPS；返回 `checksum` 并在客户端下载后校验（可在后续迭代加入）
- 变更需可控：避免通过 OTA 引入需商店审核的“重大原生能力”；仅前端资源更新

## 验证清单
- 在模拟器/真机：启动旧版本 → 发布新包 → 重启 APP → 前端版本与内容更新
- 弱网场景：首次下载后可离线使用；失败时保留旧版本回退

## 交付产物
- 我将按此方案整理服务端接口期望与前端集成要点，并提供一份操作手册（构建/上传/切换/回滚）用于你每次发版前的检查。